<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>MyFeatureLayer.as</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">wcmc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">classes</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Graphic</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">components</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">InfoWindow</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LayerEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MapPoint</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FeatureLayer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GraphicsLayer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ClassBreaksRenderer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Renderer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SimpleRenderer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UniqueValueRenderer</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ClassBreakInfo</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UniqueValueInfo</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbols</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Symbol</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">esri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tasks</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">supportClasses</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Query</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Event</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MouseEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TimerEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Point</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Timer</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">binding</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BindingUtils</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AsyncResponder</span>;
    <span class="ActionScriptASDoc">/**
     * Custom FeatureLayer that adds features for creating a legend and automatically updating the layer when the definition expression changes.
     * The class is used in a com.esri.ags.Map component and is used with a wcmc.components.Legend component to display the feature layers symbology on the fly. @see wcmc.components.Legend component
     * @author andrewcottam
     * 
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">MyFeatureLayer</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">FeatureLayer</span> <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">ILegend</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptASDoc">/**
         * Dispatched when the symbology has changed for the layer or the endUpdate layer event is fired, i.e. the data has been refreshed.
         */</span>        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"symbologyChanged"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"wcmc.classes.SymbologyChangedEvent"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * The caption for the legend for this feature layer - this is not the caption for each of the items within the feature layer. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">legendCaption</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * Sets a value to show/hide the legend. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">showlegend</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * The current state of the feature layer. If loading is true, a request has been made for the data but it has not yet completed. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loading</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * Maximum number of features that this feature layer will show. If the number of features is greater than this value then the features will not be requested. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">maxFeatureCount</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * If the maxFeatureCount is set then this flags whether the current feature layer request will result in less features than the maxFeatureCount. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">withinMaxFeatureCount</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptASDoc">/**
         * Flag to indicate if features have been loaded - this only applies in snapshot mode when all features from the layer are loaded up front - this is set to false if the definition expression changes
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">featuresLoaded</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>; 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentGraphic</span>:<span class="ActionScriptDefault_Text">Graphic</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">showTimer</span>:<span class="ActionScriptDefault_Text">Timer</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hideTimer</span>:<span class="ActionScriptDefault_Text">Timer</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">scrubTimer</span>:<span class="ActionScriptDefault_Text">Timer</span>;
        <span class="ActionScriptASDoc">/**
         * Constructor. Adds the necessary event listeners for the class. 
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">MyFeatureLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UPDATE_START</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">updateStart</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the wiring to call updateStart when the layer starts to load
</span>            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UPDATE_END</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">_updateEnd</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the wiring to call _updateEnd when the layer has finished loading
</span>            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SymbologyChangedEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SYMBOLOGYCHANGED</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">symbologyChanged</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">BindingUtils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bindSetter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">updateFeatures</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"definitionExpression"</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//bind the updates features function to the definition expression so that if it changes the function is called
</span>            <span class="ActionScriptComment">//The following are not used - the mouse over graphics event handlers are commented out - but they used to be used for showing the infoWindow on mouse over
</span><span class="ActionScriptComment">//            showTimer = new Timer(0, 1);
</span><span class="ActionScriptComment">//            showTimer.addEventListener(TimerEvent.TIMER,showInfoWindow);
</span><span class="ActionScriptComment">//            hideTimer = new Timer(0, 1);
</span><span class="ActionScriptComment">//            hideTimer.addEventListener(TimerEvent.TIMER,hideInfoWindow);
</span><span class="ActionScriptComment">//            scrubTimer = new Timer(0, 1);
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptASDoc">/**
         * I had to create this property as the graphicLayer.graphicProvider property was not binding to a DataGrid. This is programmatically populated when the layer has finishsed loading. 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">features</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; 
        <span class="ActionScriptASDoc">/**
         * Overriden function that sets the renderer for the feature layer and dispatches the SymbologyChangedEvent event.
         * @param value
         * 
         */</span>        
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">renderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">Renderer</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderer</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">value</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphicProvider</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SymbologyChangedEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SymbologyChangedEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SYMBOLOGYCHANGED</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Called when the definition expression changes. If maxFeatureCount is 0 then the feature layer is refreshed, otherwise a call is made to see how many features would be returned from the server.
         * @param object
         * 
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">maxFeatureCount</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">getFeatureCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">requestFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Called if the maxFeatureCount has been set - checks to see how many features would be returned by the current definition expression 
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getFeatureCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">withinMaxFeatureCount</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>; <span class="ActionScriptComment">//reset
</span>            <span class="ActionScriptDefault_Text">queryCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Query</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AsyncResponder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">onResult</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">count</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">token</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">withinMaxFeatureCount</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">count</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">maxFeatureCount</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Requests features from the server - this is called if the definition expression changes 
         * 
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">requestFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mode</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">MODE_SNAPSHOT</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">featuresLoaded</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>; <span class="ActionScriptComment">//reset the featuresLoaded flag 
</span>            <span class="ActionScriptDefault_Text">refresh</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Called when the layer loads. Sets the loading flag to true if the features are not loaded. 
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateStart</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">featuresLoaded</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">loading</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Called when features are returned from the server. Sets the loading flag to false and populates the features object. @see features
         * @param event 
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">_updateEnd</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LayerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">featuresLoaded</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">loading</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">populateFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">GraphicsLayer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphicProvider</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//populates the features with the ArrayCollection of graphics 
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SymbologyChangedEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SymbologyChangedEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SYMBOLOGYCHANGED</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//fire the symbology changed event
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mode</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">MODE_SNAPSHOT</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">featuresLoaded</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>; <span class="ActionScriptComment">//only if the mode is snapshot are all features loaded
</span>        <span class="ActionScriptBracket/Brace">}</span>    
        <span class="ActionScriptASDoc">/**
         * Populates the features object with the features from the graphicProvider. 
         * @param graphicProvider An ArrayCollection of graphics.
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">populateFeatures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphicProvider</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//clear the features that are already in the collection
</span>            <span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">disableAutoUpdate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//stop auto firing events every time a new item is added to the collection
</span>            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphic</span>:<span class="ActionScriptDefault_Text">Graphic</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphicProvider</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//iterate through the graphics and add them to the features
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">)</span>;    
<span class="ActionScriptComment">//                graphic.addEventListener(MouseEvent.MOUSE_OVER,mouseOverGraphic);
</span><span class="ActionScriptComment">//                graphic.addEventListener(MouseEvent.MOUSE_OUT,mouseOutGraphic);
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refresh</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//remove all of the events that would have been fired
</span>            <span class="ActionScriptDefault_Text">features</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enableAutoUpdate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//turn on normal events again
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Called when the symbology changes. If the renderer is a dynamic renderer then the infos are recreated from the dataProvider so that the legend can be updated.
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">symbologyChanged</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">IDynamicRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">IDynamicRenderer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createInfos</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphicProvider</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * The caption for the feature layer on the legend component. This is the implemeting function for the ILegend::caption member. 
         * @return The feature layers legendCaption property. @see legendCaption
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">caption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">legendCaption</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Flag to set whether to show/hide this feature layer in the legend. This is the implemeting function for the ILegend::showLegend member. 
         * @return 
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">showLegend</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">showlegend</span>; 
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Contains the collection of legend items that will be shown in the legend. This is the implemeting function for the ILegend::items member.
         * @return 
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">items</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//if the feature layer has a simple symbol then return that
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptComment">//this feature layer has a renderer so get the items for the renderer
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend item where the feature layer has a single symbol to represent the features.
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ac</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//instantiate a new array collection to hold the returned image
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createSwatch</span><span class="ActionScriptBracket/Brace">(</span>16<span class="ActionScriptOperator">,</span>16<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create a swatch from the symbol
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">caption</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getCaption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the caption for the symbol - this will be shown in the legend component
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerLegendItem</span>:<span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">caption</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//creates a new LayerLegendItem - this is the object that is bound in the Legend component 
</span>            <span class="ActionScriptDefault_Text">ac</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the layer legend item
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ac</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items where the feature layer has a renderer to symbolise the features. 
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">renderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>; <span class="ActionScriptComment">//null check
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">SimpleRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForSimpleRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the items for a simple renderer
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">MyUniqueValueRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForMyUniqueValueRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the items for a unique value renderer
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">UniqueValueRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForMyUniqueValueRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//this will actually get only the symbols that are in use, e.g for the season field, it will only return actual values used rather than the unique values
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">MyClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForDynamicClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the items for a dynamic class breaks renderer
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">ClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsForClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the items for a class breaks renderer
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a feature layer that has a simple renderer, i.e. only a single symbol is used in the renderer. 
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForSimpleRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ac</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;  <span class="ActionScriptComment">//instantiate a new array collection to hold the returned image
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">simpleRenderer</span>:<span class="ActionScriptDefault_Text">SimpleRenderer</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">SimpleRenderer</span>; <span class="ActionScriptComment">//get the renderer as a simple renderer
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">simpleRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createSwatch</span><span class="ActionScriptBracket/Brace">(</span>16<span class="ActionScriptOperator">,</span>16<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create a swatch from the symbol
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">caption</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getCaption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">simpleRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the caption for the symbol - this will be shown in the legend component
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerLegendItem</span>:<span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">caption</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//creates a new LayerLegendItem - this is the object that is bound in the Legend component 
</span>            <span class="ActionScriptDefault_Text">ac</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the layer legend item
</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ac</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a feature layer that has a simple unique value renderer, i.e. where the items don't change.
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForUniqueValueRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsFromUniqueValues</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">UniqueValueRenderer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infos</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//call a sub function to build the legend items
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">/*Returns the items for unique value renderers which do change depending on the graphics*/</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a feature layer that has a unique value rendere where the items do change depending on the actual features that are shown, e.g. season field may only contain breeding and wintering - only these will be shown in the legend
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForMyUniqueValueRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">array</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphic</span>:<span class="ActionScriptDefault_Text">Graphic</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">graphicProvider</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//build an array of the unique values that are actually in use in the feature layer
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">UniqueValueRenderer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attribute</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">inArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">array</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">array</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">UniqueValueInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSymbol</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">graphic</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsFromUniqueValues</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">array</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//call a sub function to build the legend items
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Searches for the value in the array 
         * @param value Value to search for
         * @param array Array to search in.
         * @return A boolean value indicating if the search term was found.
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">inArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">value</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">array</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">array</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a class breaks renderer dynamically from the data, i.e. it dynamically splits the data into classes. An example is the mean population renderer which splits the data on the fly.
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem @see wcmc.classes.MyClassBreaksRenderer
         * 
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForDynamicClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsFromClassBreaks</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">MyClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infos</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//dynanically creates the infos array from the data
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a feature layer that has a unique value renderer, either static or dynamic. 
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsFromUniqueValues</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">uniqueValues</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ac</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uniqueValueInfo</span>:<span class="ActionScriptDefault_Text">UniqueValueInfo</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">uniqueValues</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//iterate through the unique values and create the legend items
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">uniqueValueInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">uniqueValueInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createSwatch</span><span class="ActionScriptBracket/Brace">(</span>16<span class="ActionScriptOperator">,</span>16<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create the symbol
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">caption</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getCaption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">uniqueValueInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the caption to show in the legend
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerLegendItem</span>:<span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">caption</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create the new LayerLegendItem
</span>                <span class="ActionScriptDefault_Text">ac</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add it to the array
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ac</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a class breaks renderer using the class breaks array.
         * @param classBreaks An array of class breaks that are normally set in MXML.
         * @param useLegendCaption Determines whether to use the legend caption from the symbol in the map or to create one from the data. The default is to create one from the data, e.g. if the class break is 0-40 then the legen will be '0 - 40'
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem.
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsFromClassBreaks</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">classBreaks</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">useLegendCaption</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ac</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layerLegendItem</span>:<span class="ActionScriptDefault_Text">LayerLegendItem</span>;
            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">classBreakInfo</span>:<span class="ActionScriptDefault_Text">ClassBreakInfo</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">classBreaks</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//iterate through the class breaks
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">classBreakInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createSwatch</span><span class="ActionScriptBracket/Brace">(</span>16<span class="ActionScriptOperator">,</span>16<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create a symbol
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useLegendCaption</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//if a legend caption is to be used
</span>                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">caption</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getCaption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">classBreakInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//get the caption from the symbol
</span>                    <span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">caption</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create a LayerLegendItem with the caption
</span>                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LayerLegendItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">classBreakInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">minValue</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" - "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">classBreakInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maxValue</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create the legend caption from the data itself
</span>                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">ac</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">layerLegendItem</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ac</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the legend items for a class breaks renderer. The class breaks are not dynamically created but are normally set in MXML code. An example is the % flyway renderer which is '0% - 1%' etc.
         * @return An array collection of LayerLegendItem objects. @see wcmc.classes.LayerLegendItem @see wcmc.classes.MyClassBreaksRenderer
         * 
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getItemsForClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getItemsFromClassBreaks</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renderer</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ClassBreaksRenderer</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infos</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Returns the text to display in the legend for the symbol. If the symbol has a 'legendCaption' property then this is returned otherwise it is null.  
         * @param symbol
         * @return 
         * 
         */</span>        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getCaption</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span>:<span class="ActionScriptDefault_Text">Symbol</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"legendCaption"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//implemented in MySimpleMarkerSymbol, MySimpleFillSymbol etc.
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">legendCaption</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>    
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Not currently used. 
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mouseOverGraphic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptDefault_Text">currentGraphic</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Graphic</span>;
            <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">scrubTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">running</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">showTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">delay</span><span class="ActionScriptOperator">=</span>0 : <span class="ActionScriptDefault_Text">showTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">delay</span><span class="ActionScriptOperator">=</span>500;
            <span class="ActionScriptDefault_Text">showTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Not currently used. 
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mouseOutGraphic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">relatedObject</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">InfoWindow</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptDefault_Text">showTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">reset</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">hideTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">reset</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">scrubTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">delay</span><span class="ActionScriptOperator">=</span>100;
            <span class="ActionScriptDefault_Text">scrubTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Not currently used. 
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">showInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">TimerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">infoWindowRenderer</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">infoWindowRenderer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">newInstance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">currentGraphic</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mapPoint</span>:<span class="ActionScriptDefault_Text">MapPoint</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toMap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mouseX</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mouseY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mapPoint</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">hideTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">delay</span><span class="ActionScriptOperator">=</span>10000;
            <span class="ActionScriptDefault_Text">hideTimer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptASDoc">/**
         * Not currently used. 
         * @param event
         * 
         */</span>        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">hideInfoWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">TimerEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">infoWindow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hide</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
